#!/bin/bash
# stolen from Khai
# sm: shared memory byte transfer layer
# openib: infiniband byte transfer layer

export UCX_CM_USE_ALL_DEVICES=no
/home/testcpu/matt/local/ompi/bin/mpirun \
    -mca btl ^uct,openib \
    -mca pml ucx -x UCX_NET_DEVICES=mlx5_0:1,mlx5_1:1 \
    --hostfile /home/testcpu/matt/hostlist-atobc.txt \
    --npernode 1 \
    -np 3 \
    /home/testcpu/matt/mpi-benchmarks/IMB-MPI1 AllReduce

